"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.listFilesRecursively = void 0;
const fs_1 = require("fs");
const path_1 = require("path");
const util_1 = require("util");
const readdir = util_1.promisify(fs_1.readdir);
async function listFilesRecursively(path) {
    const promisesToWaitOn = [];
    const dirents = await readdir(path, {
        encoding: 'utf-8',
        withFileTypes: true,
    });
    const result = [];
    for (const dirent of dirents) {
        if (dirent.isFile()) {
            result.push(dirent.name);
        }
        else if (dirent.isDirectory()) {
            promisesToWaitOn.push(listFilesRecursively(path_1.join(path, dirent.name)).then((files) => result.push(...files.map((file) => path_1.join(dirent.name, file)))));
        }
    }
    await Promise.all(promisesToWaitOn);
    return result;
}
exports.listFilesRecursively = listFilesRecursively;
