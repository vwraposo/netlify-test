"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.usePixelEvent = void 0;
const react_1 = require("react");
const pixel_1 = require("./pixel");
exports.usePixelEvent = (handler) => {
    const callback = react_1.useCallback((message) => {
        var _a;
        try {
            const maybeEvent = pixel_1.unwrap((_a = message.data) !== null && _a !== void 0 ? _a : {});
            if (maybeEvent) {
                handler(maybeEvent);
            }
        }
        catch (err) {
            console.error('Some bad happened while running Pixel handler');
        }
    }, [handler]);
    react_1.useEffect(() => {
        window.addEventListener('message', callback);
        return () => window.removeEventListener('message', callback);
    }, [callback]);
};
